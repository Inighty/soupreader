seq,menu_file,item_id,title_ref,title_zh,domain,phase,status,owner,verify,notes
1,about.xml,@+id/menu_share_it,@string/share,分享,系统与工具,P10,pending,-,-,-
2,about.xml,@+id/menu_scoring,@string/scoring,评分,系统与工具,P10,pending,-,-,-
3,app_log.xml,@+id/menu_clear,@string/clear,清除,系统与工具,P10,pending,-,-,-
4,app_update.xml,@+id/menu_download,@string/action_download,下载,系统与工具,P10,pending,-,-,-
5,audio_play.xml,@+id/menu_change_source,@string/change_origin,换源,阅读与朗读,P3,done,codex,手工路径: 阅读页->底部菜单长按朗读->播放->换源; 校验播放菜单出现换源入口且点击后进入换源候选弹层,将朗读长按入口从占位提示收敛为 legado audio_play menu_change_source 同义换源动作并复用整书换源链路
6,audio_play.xml,@+id/menu_login,@string/login,登录,阅读与朗读,P3,done,codex,手工路径: 阅读页(网络书且书源配置 loginUrl)->底部菜单长按朗读->播放->登录; 校验 loginUrl 非空时显示登录入口且点击后进入登录流程，无 loginUrl 时不展示,播放菜单补齐 legado audio_play menu_login 同义入口并复用现有书源登录链路（loginUi/Web 登录）
7,audio_play.xml,@+id/menu_copy_audio_url,@string/copy_play_url,拷贝播放 URL,阅读与朗读,P3,done,codex,手工路径: 阅读页->底部菜单长按朗读->播放->拷贝播放 URL; 校验点击后剪贴板写入当前章节链接文本（允许为空）且提示“已拷贝”,播放菜单补齐 legado audio_play menu_copy_audio_url 同义入口并复用章节链接解析为当前播放 URL；复制动作保持“可空也可复制”边界并提示已拷贝
8,audio_play.xml,@+id/menu_edit_source,@string/edit_book_source,编辑书源,阅读与朗读,P3,done,codex,手工路径: 阅读页(网络书) -> 底部菜单长按朗读 -> 播放 -> 编辑书源; 校验可进入编辑书源页，取消返回不刷新，保存返回后刷新当前书源展示,播放菜单补齐 legado audio_play menu_edit_source，同步复用阅读域编辑书源链路并保持仅保存返回刷新（取消不生效）
9,audio_play.xml,@+id/menu_wake_lock,@string/audio_play_wake_lock,音频服务唤醒锁,阅读与朗读,P3,done,codex,手工路径: 阅读页->底部菜单长按朗读->播放->音频服务唤醒锁; 校验入口勾选态与开关状态同步且切换后再次进入保持状态,播放菜单补齐 legado audio_play menu_wake_lock 同义 checkable 语义并持久化到 audioPlayWakeLock
10,audio_play.xml,@+id/menu_log,@string/log,日志,阅读与朗读,P3,done,codex,手工路径: 阅读页->底部菜单长按朗读->播放->日志; 校验点击后打开日志弹层并可关闭,播放菜单补齐 legado audio_play menu_log 常驻入口并接入 showAppLogDialog；点击直接打开日志弹层且无前置条件限制
11,backup_restore.xml,@+id/menu_help,@string/help,帮助,导入导出与备份,P8,pending,-,-,-
12,backup_restore.xml,@+id/menu_log,@string/log,日志,导入导出与备份,P8,pending,-,-,-
13,book_cache.xml,@+id/menu_download,@string/action_download,下载,书架/缓存/分组,P6,done,codex,命令: dart format lib/features/bookshelf/services/cache_download_task_service.dart lib/features/bookshelf/views/cache_export_view.dart lib/features/bookshelf/views/cache_export_placeholder_view.dart lib/features/bookshelf/views/bookshelf_view.dart；flutter test test/widget_test.dart 通过；flutter test test/search_book_info_view_compile_test.dart test/simple_reader_view_compile_test.dart 通过；手工路径（待回归）: 书架->更多->缓存/导出->下载->确定；校验下载前出现“提醒/是否确认缓存当前列表书籍？”，下载中顶栏动作切换“停止”，停止后回落“下载”且已缓存章节计数增长,对齐 legado CacheActivity.menu_download 与 CacheBook.start/stop 语义: 顶栏一级下载入口默认执行“当前章节到末章”批量缓存；运行中同入口切换为停止；点击前需确认且失败仅记录日志
14,book_cache.xml,@+id/menu_book_group,@string/group,分组,书架/缓存/分组,P6,done,codex,命令: dart format lib/features/bookshelf/views/cache_export_view.dart；手工路径（待回归）: 书架->更多->缓存/导出->顶栏分组->切换 全部 本地 网络未分组 本地未分组,对齐 legado CacheActivity.menu_book_group 语义: 顶栏新增一级分组入口；菜单回显当前分组并按分组切换当前列表；下载与导出动作仅作用于当前分组列表
15,book_cache.xml,@+id/menu_export_all,@string/export_all,导出所有,书架/缓存/分组,P6,done,codex,命令: dart format lib/features/bookshelf/services/cache_export_task_service.dart lib/features/bookshelf/views/cache_export_view.dart；flutter test test/widget_test.dart 通过；flutter test test/search_book_info_view_compile_test.dart test/simple_reader_view_compile_test.dart 通过；手工路径（待回归）: 书架->更多->缓存/导出->更多->导出所有->选择导出文件夹；校验导出完成弹窗显示成功/跳过/失败统计与导出目录,对齐 legado CacheActivity.menu_export_all 语义: 顶栏更多菜单触发导出所有；优先复用已保存导出目录，不可用时重新选择目录；按当前列表书籍批量导出已缓存章节 TXT 并记录失败日志（自定义 Epub 导出与导出格式配置保留到 seq17/24）
16,book_cache.xml,@+id/menu_enable_replace,@string/replace_purify,替换净化,书架/缓存/分组,P6,done,codex,命令: dart format lib/features/bookshelf/services/cache_export_task_service.dart lib/features/bookshelf/views/cache_export_view.dart；手工路径（待回归）: 书架->更多->缓存/导出->更多->替换净化；切换后执行导出所有并比对替换规则命中前后文本差异（TXT 与 EPUB）,对齐 legado CacheActivity.menu_enable_replace + ExportBookService.useReplace 语义: 顶栏更多菜单补齐 checkable“替换净化”入口；菜单打开按 exportUseReplace 回显勾选态；点击后翻转并持久化同名键；导出链路仅在 exportUseReplace 与书籍替换净化开关同时开启时应用替换规则
17,book_cache.xml,@+id/menu_enable_custom_export,@string/custom_export_section,自定义Epub导出章节,书架/缓存/分组,P6,done,codex,命令: dart format lib/features/bookshelf/services/cache_export_task_service.dart lib/features/bookshelf/views/cache_export_view.dart；flutter test test/widget_test.dart 通过；flutter test test/search_book_info_view_compile_test.dart test/simple_reader_view_compile_test.dart 通过；手工路径（待回归）: 书架->更多->缓存/导出->更多->自定义Epub导出章节；返回后重进缓存/导出页再次打开更多；校验勾选态切换与持久化回显,对齐 legado CacheActivity.menu_enable_custom_export 语义: 顶栏更多菜单补齐 checkable“自定义Epub导出章节”入口；菜单打开按 enableCustomExport 回显勾选态；点击后翻转并持久化同名键（导出行为联动保留到 seq18~25）
18,book_cache.xml,@+id/menu_export_web_dav,@string/export_to_web_dav,导出到 WebDav,书架/缓存/分组,P6,done,codex,命令: dart format lib/features/bookshelf/services/cache_export_task_service.dart lib/features/bookshelf/views/cache_export_view.dart；flutter test test/widget_test.dart 通过；flutter test test/search_book_info_view_compile_test.dart test/simple_reader_view_compile_test.dart 通过；手工路径（待回归）: 书架->更多->缓存/导出->更多->导出到 WebDav；返回后重进缓存/导出页再次打开更多；校验勾选态切换与持久化回显,对齐 legado CacheActivity.menu_export_web_dav 语义: 顶栏更多菜单补齐 checkable“导出到 WebDav”入口；菜单打开按 webDavCacheBackup 回显勾选态；点击后翻转并持久化同名键（实际导出上传能力由后续导出链路序号继续收敛）
19,book_cache.xml,@+id/menu_export_no_chapter_name,@string/export_no_chapter_name,TXT 不导出章节名,书架/缓存/分组,P6,done,codex,命令: dart format lib/features/bookshelf/services/cache_export_task_service.dart lib/features/bookshelf/views/cache_export_view.dart；flutter test test/widget_test.dart 通过；flutter test test/search_book_info_view_compile_test.dart test/simple_reader_view_compile_test.dart 通过；手工路径（待回归）: 书架->更多->缓存/导出->更多->TXT 不导出章节名；开启后执行导出所有并检查 txt 输出不包含章节标题，关闭后恢复章节标题输出,对齐 legado CacheActivity.menu_export_no_chapter_name + ExportBookService.includeTitle 语义: 顶栏更多菜单补齐 checkable“TXT 不导出章节名”入口；菜单打开按 exportNoChapterName 回显勾选态；点击后翻转并持久化同名键并驱动 TXT 导出章节标题开关
20,book_cache.xml,@+id/menu_export_pics_file,@string/export_pics_file,TXT 导出图片,书架/缓存/分组,P6,done,codex,命令: dart format lib/features/bookshelf/services/cache_export_task_service.dart lib/features/bookshelf/views/cache_export_view.dart；flutter test test/widget_test.dart 通过；手工路径（待回归）: 书架->更多->缓存/导出->更多->TXT 导出图片->开启后执行导出所有；校验导出目录生成 {书名_作者}/images/{章节} 图片文件且开关状态可持久化回显,对齐 legado CacheActivity.menu_export_pics_file + ExportBookService.exportTxt 语义: 顶栏更多菜单补齐 checkable“TXT 导出图片”入口；菜单打开按 exportPictureFile 回显勾选态；点击后翻转并持久化同名键并在 TXT 导出中解析章节 <img src> 后按书籍/章节目录写出图片文件
21,book_cache.xml,@+id/menu_parallel_export,@string/parallel_export_book,多线程导出,书架/缓存/分组,P6,done,codex,命令: dart format lib/features/bookshelf/services/cache_export_task_service.dart lib/features/bookshelf/views/cache_export_view.dart；手工路径（待回归）: 书架->更多->缓存/导出->更多->多线程导出（校验勾选态切换与持久化回显）；开启后执行导出所有（校验并发导出开关生效，导出成功/失败统计正常）,对齐 legado CacheActivity.menu_parallel_export + ExportBookService.parallelExportBook 语义: 顶栏更多菜单补齐 checkable“多线程导出”入口；菜单打开按 parallelExportBook 回显勾选态；点击后翻转并持久化同名键；导出链路按开关切换并发度（关闭=1，开启=9）
22,book_cache.xml,@+id/menu_export_folder,@string/export_folder,导出文件夹,书架/缓存/分组,P6,done,codex,手工路径: 书架->更多->缓存/导出->顶栏更多->导出文件夹；校验选择目录后返回列表无导出任务触发并在后续导出所有时可复用新目录,对齐 legado CacheActivity.menu_export_folder 语义: 顶栏更多菜单新增导出文件夹一级入口；点击后仅打开目录选择并保存 exportBookPath，取消选择静默返回且不触发导出
23,book_cache.xml,@+id/menu_export_file_name,@string/export_file_name,导出文件名,书架/缓存/分组,P6,done,codex,命令: dart format lib/features/bookshelf/services/cache_export_task_service.dart lib/features/bookshelf/views/cache_export_view.dart；手工路径（待回归）: 书架->更多->缓存/导出->更多->导出文件名->输入 name + 作者 + author->确定->导出所有；校验导出文件名按规则生成且规则非法时回退默认命名并记录日志,对齐 legado CacheActivity.menu_export_file_name + Book.getExportFileName 语义: 顶栏更多菜单新增导出文件名入口；弹窗标题“导出文件名”、提示“Variable: name, author.”、输入 hint“file name js”；确认后写入同名键 bookExportFileName；TXT 导出命名改为按 JS 规则解析（变量 name/author，异常回退默认名并记录日志）
24,book_cache.xml,@+id/menu_export_type,@string/export_type,导出格式,书架/缓存/分组,P6,done,codex,命令: dart format lib/features/bookshelf/services/cache_export_task_service.dart lib/features/bookshelf/views/cache_export_view.dart；手工路径（待回归）: 书架->更多->缓存/导出->更多->导出格式(txt/epub)->切换后执行导出所有,对齐 legado CacheActivity.menu_export_type + startExport 语义: 顶栏更多菜单新增“导出格式(当前值)”入口并回显当前格式；点击后单选切换并持久化 exportType；导出所有按 exportType 分支执行（txt/epub）
25,book_cache.xml,@+id/menu_export_charset,@string/export_charset,导出编码,书架/缓存/分组,P6,done,-,-,-
26,book_cache.xml,@+id/menu_log,@string/log,日志,书架/缓存/分组,P6,pending,-,-,-
27,book_cache_download.xml,@+id/menu_download_after,@string/menu_download_after,下载之后章节,书架/缓存/分组,P6,done,codex,命令: dart format lib/features/bookshelf/views/cache_export_view.dart；手工路径（待回归）: 书架->更多->缓存/导出->长按顶栏下载->下载之后章节；校验触发后与顶栏“下载”一致：未运行时弹“提醒/是否确认缓存当前列表书籍？”并从当前章节缓存到末章，运行中触发则停止任务,对齐 legado CacheActivity.menu_download_after 语义: 下载按钮长按弹层新增“下载之后章节”入口；点击后与 menu_download 同义复用“当前章节到末章”缓存链路并保持运行中可停止
28,book_cache_download.xml,@+id/menu_download_all,@string/menu_download_all,下载全部章节,书架/缓存/分组,P6,done,codex,命令: dart format lib/features/bookshelf/views/cache_export_view.dart lib/features/bookshelf/services/cache_download_task_service.dart；手工路径（待回归）: 书架->更多->缓存/导出->长按顶栏下载->下载全部章节；校验确认后从第1章开始缓存到末章并回显进度，缓存进行中再次长按触发下载全部章节应停止任务并回落“下载”态,对齐 legado CacheActivity.menu_download_all 语义: 下载按钮长按弹层新增“下载全部章节”入口；点击后在空闲态复用 sure_cache_book 确认并以 0..lastChapterIndex 范围执行缓存，运行中触发则走 CacheBook.stop 停止任务
29,book_group_manage.xml,@+id/menu_add,@string/add_group,添加分组,书架/缓存/分组,P6,done,codex,命令: dart format lib/features/bookshelf/services/bookshelf_book_group_store.dart lib/features/bookshelf/views/bookshelf_group_manage_placeholder_dialog.dart；手工路径（待回归）: 书架->更多->分组管理->右上角添加->填写分组名称/选择封面/排序/允许下拉刷新->确定；校验名称为空提示“分组名称不能为空”且可选择封面与排序并保存；达到64组时提示“分组已达上限(64个)”并禁止继续添加,对齐 legado book_group_manage/menu_add + GroupManageDialog.menu_add + GroupEditDialog.add 语义: 分组管理弹层右上角“添加分组”一级动作点击后进入结构化编辑弹窗（分组名称/封面/排序/允许下拉刷新）；确认后按 legacy 未使用位 groupId 与 maxOrder+1 写入分组存储并刷新列表
30,book_info.xml,@+id/menu_edit,@string/edit,编辑,搜索/详情/目录,P2,done,codex,flutter test test/search_book_info_edit_helper_test.dart test/search_book_info_menu_helper_test.dart test/search_book_info_view_edit_action_test.dart 通过; 手工路径: 书架点开书籍详情->顶栏编辑->进入编辑书籍信息页,确认仅书架内书籍显示编辑入口并保持 legado menu_edit->BookInfoEditActivity 同义触发语义
67,book_read.xml,@+id/menu_toc_regex,@string/txt_toc_rule,TXT 目录规则,阅读与朗读,P3,done,codex,flutter test test/reader_txt_toc_rule_dialog_test.dart test/reader_top_menu_test.dart test/reader_legacy_menu_helper_test.dart test/simple_reader_view_compile_test.dart 通过; 手工路径: 阅读页->本地 TXT 书籍->顶部 TXT 目录规则->选择规则->确定,确认取消不生效且确定后立即重建目录并保持 menu_toc_regex 同义触发语义
68,book_read.xml,@+id/menu_set_charset,@string/set_charset,设置编码,阅读与朗读,P3,done,codex,flutter test test/reader_top_menu_test.dart test/reader_legacy_menu_helper_test.dart test/simple_reader_view_compile_test.dart 通过; 手工路径: 阅读页->本地书籍->顶部设置编码->输入 GBK -> 确定,确认设置编码入口为顶栏一级动作且阅读操作菜单不再出现该项，输入式对话框支持自由输入并在本地 TXT 与非 TXT 场景都触发目录重载，取消不生效且不追加扩展成功提示
69,book_read.xml,@+id/menu_add_bookmark,@string/bookmark_add,添加书签,阅读与朗读,P3,done,codex,手工路径: 阅读页->阅读操作->添加书签；阅读页九宫格点击动作配置为“添加书签”后点击触发；校验均弹出书签编辑框，取消不落库，确定后新增书签并在目录书签页可见,将 menu_add_bookmark 从“有则删无则加”收敛为 legado 同义“始终打开编辑弹窗后确认新增”；默认预填当前阅读页文本并记录章节进度，书签跳转补齐按 chapterPos 恢复阅读进度
70,book_read.xml,@+id/menu_edit_content,@string/edit_content,编辑内容,阅读与朗读,P3,done,codex,手工路径: 阅读页->阅读操作->编辑正文->重置；阅读页->阅读操作->编辑正文->关闭；阅读页->阅读操作->反转内容,补齐 menu_edit_content 正文抓取失败兜底：记录 reader.menu.<action>.fetch_content_failed 日志并回退当前显示内容；编辑页重置期间新增全屏遮罩与整页交互锁定，关闭/返回保持自动保存语义
71,book_read.xml,@+id/menu_page_anim,@string/book_page_anim,翻页动画（本书）,阅读与朗读,P3,done,codex,flutter test test/reader_legacy_menu_helper_test.dart test/simple_reader_view_compile_test.dart 通过；手工路径: 阅读页->阅读操作->翻页动画（本书）->选择 默认/覆盖/滑动/仿真/滚动/无,菜单动作由打开界面设置收敛为 legado 同义单选弹层；新增本书翻页动画持久化并在阅读会话叠加覆盖；样式面板改全局翻页动画时清除本书覆盖以对齐 legado pageAnim=-1 边界
72,book_read.xml,@+id/menu_get_progress,@string/get_book_progress,拉取云端进度,阅读与朗读,P3,done,codex,手工路径: 阅读页(已配置 WebDav)->阅读操作->获取进度; 校验云端无进度静默返回、云端进度落后时弹“当前进度超过云端，是否覆盖为云端进度？”确认框、越界章节索引不覆盖本地进度,拉取链路收敛为 legado 同义：无配置/空目录/云端无数据时静默返回；失败仅写 reader.menu.get_progress.failed 日志；云端进度领先时直接同步并记录“自动同步阅读进度成功《书名》 章节名”日志；兼容 legado 原始 durChapterPos 场景时按章节内容长度估算章节进度
73,book_read.xml,@+id/menu_cover_progress,@string/cover_book_progress,覆盖云端进度,阅读与朗读,P3,done,codex,手工路径: 阅读页(已配置 WebDav)->阅读操作->覆盖云端进度; 校验同步开关关闭/未配置/空目录时静默返回，上传成功提示“上传成功”，上传失败提示“上传进度失败\\n<原因>”且日志页可观测,覆盖进度链路收敛为 legado 同义：先保存本地进度再上传；失败写 reader.menu.cover_progress.failed 日志并保留失败提示；菜单文案由“覆盖进度”收敛为“覆盖云端进度”
74,book_read.xml,@+id/menu_reverse_content,@string/reverse_content,反转内容,阅读与朗读,P3,done,codex,手工路径: 阅读页(网络书且当前章节已缓存正文)->阅读操作->反转内容; 校验入口仅在线书显示、点击后当前章节正文按字符级倒序并立即刷新、无缓存正文时静默返回,将 menu_reverse_content 从“按行倒序 + 缺正文提示 + 兜底拉取正文”收敛为 legado 同义“按字符倒序 + 仅处理已缓存正文 + 缺失静默返回”；菜单文案由“正文倒序”收敛为“反转内容”
75,book_read.xml,@+id/menu_simulated_reading,@string/simulated_reading,模拟追读,阅读与朗读,P3,done,codex,flutter test test/simple_reader_view_compile_test.dart 通过; flutter test test/reader_legacy_menu_helper_test.dart 通过; flutter test test/reader_catalog_sheet_test.dart 通过,将 menu_simulated_reading 从“自动阅读占位开关”收敛为 legado 同义“配置弹窗(启用/起始章节/每日章节/开始日期) -> 落盘 -> 重载阅读会话”；补齐 simulatedTotalChapterNum 同义计算并将目录可见章节数与底部章节导航上限对齐到可读章节边界
76,book_read.xml,@+id/menu_enable_replace,@string/replace_rule_title,替换净化,阅读与朗读,P3,done,codex,flutter test test/reader_legacy_menu_helper_test.dart 通过; flutter test test/simple_reader_view_compile_test.dart 通过,将 menu_enable_replace 从“启用替换规则 + 切换后 toast”收敛为 legado 同义“替换净化 checkable 入口 + 点击即切换并刷新正文（无额外提示）”；菜单文案统一为“替换净化”，状态保持按书籍级 useReplaceRule 持久化
77,book_read.xml,@+id/menu_same_title_removed,@string/same_title_removed,移除重复标题,阅读与朗读,P3,done,codex,flutter test test/reader_legacy_menu_helper_test.dart 通过; flutter test test/simple_reader_view_compile_test.dart 通过; 手工路径: 阅读页->阅读操作->移除重复标题,菜单文案由“同名标题去重”收敛为 legado 同义“移除重复标题”；勾选态收敛为“当前章节实际发生重复标题移除”；点击动作收敛为 legado 同义“按 !sameTitleRemoved 翻转章节级开关并重载当前章节”，仅在“当前章节未移除且已处于启用态”提示“未找到可移除的重复标题”，章节缺失场景静默返回
78,book_read.xml,@+id/menu_re_segment,@string/re_segment,重新分段,阅读与朗读,P3,done,codex,手工路径: 阅读页->阅读操作->重新分段; 校验勾选态随书籍级开关切换并立即重载当前章节且不追加提示,动作收敛为 legado 同义“切换书籍级 reSegment 后直接重载正文”；重载前先保存当前进度并按当前章节恢复位置以避免阅读位置漂移
79,book_read.xml,@+id/menu_enable_review,@string/review,段评,阅读与朗读,P3,done,codex,手工路径: 阅读页->阅读操作; 校验菜单不显示“段评”且其它菜单顺序保持不变,对照 legado `book_read.xml` 中 `menu_enable_review` 默认 `visible=false` 且 `ReadBookActivity` 事件分支处于注释状态；SoupReader 补齐隐藏占位动作并保持默认不展示不触发以对齐同义语义
80,book_read.xml,@+id/menu_del_ruby_tag,@string/del_ruby_tag,删除ruby标签,阅读与朗读,P3,done,codex,手工路径: 阅读页(EPUB书籍)->阅读操作->删除ruby标签; 校验入口仅 EPUB 显示、勾选态随开关切换、切换后触发全量内容刷新并重载当前章节,对照 legado `menu_del_ruby_tag`：文案由“删除 ruby 标签”收敛为“删除ruby标签”；清理规则由“删除 ruby/rt/rp 标签”收敛为仅删除 `rt/rp`；切换后刷新由“保留当前章内存内容的清缓存”收敛为全量清缓存并重载当前章节以贴齐 `refreshContentAll`
81,book_read.xml,@+id/menu_del_h_tag,@string/del_h_tag,删除h标签,阅读与朗读,P3,done,codex,手工路径: 阅读页(EPUB书籍)->阅读操作->删除h标签; 校验入口仅 EPUB 显示、勾选态切换后整段 h1~h6 节点(含标题文本)从正文移除、切换后全量清缓存并重载当前章节且无额外提示,对照 legado menu_del_h_tag：文案由“删除 h 标签”收敛为“删除h标签”；h 标签处理由“仅去标签保留标题文本”收敛为“删除 h1~h6 整段节点内容”；切换后继续复用全量清缓存并重载当前章节链路，保持 checkable 语义
82,book_read.xml,@+id/menu_image_style,@string/image_style,图片样式,阅读与朗读,P3,done,codex,手工路径: 阅读页->阅读操作->图片样式->选择 DEFAULT/FULL/TEXT/SINGLE; 校验样式切换后正文即时重载且 SINGLE 分支仅当前书籍强制覆盖翻页动画,对齐 legado menu_image_style 语义: 四档样式按书籍级持久化; SINGLE 联动由“全局改覆盖”收敛为“仅书籍级 pageAnim=覆盖”且不污染全局设置
83,book_read.xml,@+id/menu_update_toc,@string/update_toc,更新目录,阅读与朗读,P3,done,codex,flutter test test/reader_top_menu_test.dart test/reader_legacy_menu_helper_test.dart test/simple_reader_view_compile_test.dart test/search_book_info_refresh_helper_test.dart 通过; flutter test test/reader_catalog_sheet_test.dart 通过; 手工路径: 阅读页->阅读操作->更新目录（在线书与本地 TXT/EPUB 分别验证）,确认在线失败提示收敛为“加载目录失败”且本地失败提示收敛为 LoadTocError 前缀并移除成功扩展提示
84,book_read.xml,@+id/menu_effective_replaces,@string/effective_replaces,起效的替换,阅读与朗读,P3,done,codex,手工路径: 阅读页->阅读操作->起效的替换; 选择命中规则进入编辑并保存返回; 选择“繁简转换”并切换模式,阅读菜单入口从规则总列表收敛为当前章节起效替换弹层；仅展示当前章节正文实际命中的替换规则并在简繁转换开启时追加“繁简转换”；编辑后按 replaceRuleChanged 语义重载当前章节
87,book_read_change_source.xml,@+id/menu_chapter_change_source,@string/chapter_change_source,单章换源,阅读与朗读,P3,done,codex,手工路径: 阅读页(网络书)->顶部换源按钮长按->单章换源->选择候选书源->选择目标章节; 校验当前章节正文被替换且阅读位置保持在当前章节,单章换源流程收敛为“先选书源再选目标章节后替换当前章节正文”；移除自动匹配章节后立即覆盖与成功提示扩展分支，对齐 legado ChangeChapterSourceDialog 的手动选章语义
88,book_read_change_source.xml,@+id/menu_book_change_source,@string/book_change_source,整书换源,阅读与朗读,P3,done,codex,手工路径: 阅读页(网络书)->顶部换源按钮长按->整书换源->选择候选书源; 校验整书来源与目录切换生效且无成功提示,分支菜单文案由“书籍换源”收敛为 legado 同义“整书换源”；整书换源成功反馈收敛为静默不再弹“已切换到...”扩展 toast；触发链路保持与 menu_change_source 同步复用整书换源流程
93,book_read_record.xml,@+id/menu_enable_record,@string/enable_record,开启记录,阅读与朗读,P3,done,codex,手工路径: 设置->功能 & 设置->阅读记录->右上角更多->开启记录; 校验勾选态切换与重进页面保持,对齐 legado menu_enable_record checkable 语义：菜单打开按 enableReadRecord 回显勾选；点击仅翻转开关并持久化，不追加提示；阅读进度保存保持不变且仅在开关关闭时不刷新 lastReadTime
94,book_read_refresh.xml,@+id/menu_refresh_dur,@string/menu_refresh_dur,刷新当前章节,阅读与朗读,P3,done,codex,flutter test test/reader_legacy_menu_helper_test.dart test/reader_top_menu_test.dart test/simple_reader_view_compile_test.dart 通过; 手工路径: 阅读页->顶部刷新按钮(点击) 与 阅读页->顶部刷新按钮(长按)->刷新当前章节; 确认 menu_refresh 与 menu_refresh_dur 同分支并默认执行刷新当前章节,
95,book_read_refresh.xml,@+id/menu_refresh_after,@string/menu_refresh_after,刷新之后章节,阅读与朗读,P3,done,codex,flutter test test/reader_refresh_scope_helper_test.dart test/reader_legacy_menu_helper_test.dart test/reader_top_menu_test.dart test/simple_reader_view_compile_test.dart 通过; 手工路径: 阅读页->顶部刷新按钮(长按)->刷新之后章节; 确认从当前章节开始清理后续缓存并触发当前章节重载，前序章节缓存保持不变,
96,book_read_refresh.xml,@+id/menu_refresh_all,@string/menu_refresh_all,刷新全部章节,阅读与朗读,P3,done,codex,flutter test test/reader_refresh_scope_helper_test.dart test/reader_legacy_menu_helper_test.dart test/reader_top_menu_test.dart test/simple_reader_view_compile_test.dart 通过; 手工路径: 阅读页->顶部刷新按钮(长按)->刷新全部章节; 确认从首章开始清理全量章节缓存并回写变更章节，随后重载当前章节，且无可用书源时回落当前章节重载,
97,book_read_source.xml,@+id/menu_login,@string/login,登录,阅读与朗读,P3,done,codex,手工路径: 阅读页(网络书)->顶部书源名->登录; 校验 loginUrl 为空时菜单不显示登录，loginUrl 非空点击后可进入登录流程（表单登录或网页登录）,登录动作改为按 bookSourceUrl 回查当前书源后再触发，缺失时提示“未找到书源”，以对齐 legado SourceLoginActivity 的实时状态边界
98,book_read_source.xml,@+id/menu_chapter_pay,@string/chapter_pay,购买,阅读与朗读,P3,done,codex,手工路径: 阅读页(网络书,VIP未购买章节)->顶部书源名->章节购买->确定; 校验仅 loginUrl 非空且当前章节 isVip=true 且 isPay!=true 显示入口，确认后按 payAction 结果分流（URL 打开网页，truthy 结果清缓存并刷新目录），异常仅写日志且不追加扩展提示
99,book_read_source.xml,@+id/menu_edit_source,@string/edit_book_source,编辑书源,阅读与朗读,P3,done,codex,手工路径: 阅读页(网络书)->顶部书源名->编辑书源; 校验点击后按当前 sourceUrl 回查书源并进入编辑书源页，弹层期间若书源被删除则提示未找到书源，编辑后仅保存返回时刷新阅读页书源显示,编辑动作由使用弹层快照 source 直接打开收敛为 legado 同义的按 bookSourceUrl 实时回查后打开；保存返回才刷新菜单书源显示以对齐 RESULT_OK 回调语义
100,book_read_source.xml,@+id/menu_disable_source,@string/disable_book_source,禁用书源,阅读与朗读,P3,done,codex,手工路径: 阅读页(网络书)->顶部书源名->禁用书源; 校验点击后按 bookSourceUrl 回查当前书源并直接写库禁用，无确认弹窗且无成功提示,禁用动作由弹层快照 source 直接写库收敛为 legado 同义的按 bookSourceUrl 实时回查后禁用；回查缺失时提示“未找到书源”
164,book_toc.xml,@+id/menu_split_long_chapter,@string/split_long_chapter,拆分超长章节,搜索/详情/目录,P2,done,codex,手工路径: 书籍详情页->查看目录->更多->拆分超长章节; 校验仅本地 TXT 显示勾选态并切换后即时重建目录,目录页补齐 menu_split_long_chapter 勾选入口并复用本地 TXT 重解析链路; 切换后同步刷新目录列表与勾选状态
166,book_toc.xml,@+id/menu_use_replace,@string/use_replace,使用替换,搜索/详情/目录,P2,done,codex,手工路径: 书籍详情页->查看目录->更多->使用替换; 校验固定文案+勾选态切换且不弹成功提示，切换后目录标题即时按替换规则刷新,目录页补齐 menu_use_replace 全局开关并持久化到 tocUiUseReplace；展示链路收敛为 tocUiUseReplace && 书籍启用替换规则
167,book_toc.xml,@+id/menu_load_word_count,@string/load_word_count,加载字数,搜索/详情/目录,P2,done,codex,flutter test test/search_book_info_view_compile_test.dart test/simple_reader_view_compile_test.dart test/reader_catalog_sheet_test.dart 通过; 手工路径: 书籍详情页->查看目录->更多->加载字数; 校验固定文案+勾选态切换且不弹成功提示，目录项字数按开关即时显隐,目录页补齐 menu_load_word_count 全局开关并持久化到 toc_ui_load_word_count；目录项在开关开启且存在可用字数时显示 xx字/xx万字
171,bookmark.xml,@+id/menu_export,@string/export,导出,书架/缓存/分组,P6,done,codex,命令: dart format lib/core/database/repositories/bookmark_repository.dart lib/features/reader/services/reader_bookmark_export_service.dart lib/features/reader/views/all_bookmark_view.dart lib/features/settings/views/settings_view.dart；手工路径（待回归）: 设置->功能 & 设置->书签->右上角更多->导出；校验导出成功提示且导出文件名为 bookmark-yyMMddHHmmss.json,对齐 legado AllBookmarkActivity.menu_export 语义: 补齐“设置->书签->所有书签”入口与全量书签承载页；顶栏更多菜单新增“导出”并按 bookmarkDao.all 同义排序（bookName/bookAuthor/chapterIndex/chapterPos）导出 JSON；取消导出静默返回，失败写 ExceptionLogService(node=all_bookmark.menu_export)
172,bookmark.xml,@+id/menu_export_md,@string/export_md,导出(MD),书架/缓存/分组,P6,done,codex,命令: dart format lib/features/reader/services/reader_bookmark_export_service.dart lib/features/reader/views/all_bookmark_view.dart；手工路径（待回归）: 设置->功能 & 设置->书签->右上角更多->导出(MD)；校验导出文件名为 bookmark-yyMMddHHmmss.md 且提示“导出成功”并在取消目录选择时静默返回,对齐 legado AllBookmarkActivity.menu_export_md 语义: 顶栏更多菜单补齐“导出(MD)”动作并复用同一目录选择流程；导出内容按 bookmarkDao.all 顺序输出 Markdown 分组（书名作者/章节/原文/摘要）；失败记录 ExceptionLogService(node=all_bookmark.menu_export_md)
175,bookshelf_manage.xml,@+id/menu_export_all_use_book_source,@string/export_all_use_book_source,导出所有书的书源,书架/缓存/分组,P6,done,codex,命令: dart format lib/features/bookshelf/services/bookshelf_manage_export_service.dart lib/features/bookshelf/views/bookshelf_manage_placeholder_view.dart；手工路径（待回归）: 书架->更多->书架管理->右上角更多->导出所有书的书源；校验默认文件名为 bookSource.json 且取消导出静默返回并在成功后可复制导出路径,对齐 legado BookshelfManageActivity.menu_export_all_use_book_source 语义: 顶栏菜单补齐“导出所有书的书源”入口；导出集合按在用线上书源收敛（过滤本地与 WebDav 标签来源并仅导出书源仓库可命中项）；导出失败提示错误摘要并保留可观测日志
201,content_edit.xml,@+id/menu_save,@string/action_save,保存,阅读与朗读,P3,done,codex,手工路径: 阅读页->阅读操作->编辑正文->清空正文后点保存 或 关闭; 校验不覆盖当前章节已缓存正文并返回阅读页,编辑正文保存链路补齐 legado menu_save 同义空正文边界：仅当正文非空时才落库覆盖章节内容；保留保存后返回阅读页且正文刷新
202,content_edit.xml,@+id/menu_reset,@string/reset,重置,阅读与朗读,P3,done,codex,手工路径: 阅读页(网络书)->阅读操作->编辑正文->重置 与 阅读页(本地 TXT/EPUB)->阅读操作->编辑正文->重置; 校验重置后编辑框回填源正文并刷新当前章节，失败时无重置失败弹窗,编辑正文重置链路补齐 legado menu_reset 同义：先清缓存再回源读取正文；网络书失败时静默保留当前编辑内容并记录日志；本地书改为从本地文件回读章节正文
204,content_search.xml,@+id/menu_enable_replace,@string/replace,替换,阅读与朗读,P3,done,codex,手工路径: 阅读页->搜索正文->输入关键词搜索->搜索面板顶栏更多->替换->再次搜索; 校验勾选态切换有效且仅影响全文搜索替换流程，退出全文搜索后开关恢复默认关闭,对齐 legado SearchContentActivity.menu_enable_replace 语义：补齐全文搜索 checkable“替换”入口；点击仅翻转搜索态开关不自动重跑；搜索链路按“搜索替换开关 && 书籍替换净化开关”决定是否应用替换规则
205,content_select_action.xml,@+id/menu_replace,@string/replace,替换,阅读与朗读,P3,done,codex,手工路径: 阅读页(翻页模式)->长按正文词句->文本操作->替换->保存规则; 校验默认 pattern 为选中文本逐行 trim 后结果 且 scope 为 书名;书源URL,对齐 legado TextActionMenu.menu_replace：补齐翻页阅读长按选中文本入口并接入 文本操作->替换；替换编辑页按 selectedText(逐行trim) 预填 pattern 且 scope 预填 bookName;bookSourceUrl；保存后回写规则并刷新当前章节
207,content_select_action.xml,@+id/menu_bookmark,@string/bookmark,书签,阅读与朗读,P3,done,codex,手工路径: 阅读页(翻页模式)->长按正文词句->文本操作->书签->取消/确定; 校验取消不落库，确定后新增书签且目录书签页可见并可跳转,对齐 legado TextActionMenu.menu_bookmark：补齐文本操作->书签入口；点击后以选中文本预填书签编辑弹窗，取消不写库，确定后写库并刷新书签状态
208,content_select_action.xml,@+id/menu_aloud,@string/read_aloud,朗读,阅读与朗读,P3,done,codex,手工路径: 阅读页(翻页模式)->长按正文词句->文本操作->朗读(点击/长按); 校验点击按模式执行“朗读选择内容/从选择处开始一直朗读”，长按任意文本操作菜单项可在两种模式间切换并持久化,对齐 legado TextActionMenu.menu_aloud：补齐文本操作“朗读”入口；默认模式朗读选中文本，长按切换后改为从选择处开始持续朗读；模式键持久化为 contentSelectSpeakMod
209,content_select_action.xml,@+id/menu_dict,@string/dict,字典,阅读与朗读,P3,done,codex,手工路径: 阅读页(翻页模式)->长按正文词句->文本操作->字典; 校验弹出字典面板、默认加载首个启用规则并支持规则切换后重新查询,对齐 legado TextActionMenu.menu_dict：补齐文本操作“字典”入口；点击后打开字典弹层并以 selectedText 发起词典查询（规则按 enabled + sortNumber 排序）
210,content_select_action.xml,@+id/menu_search_content,@string/search_content,全文搜索,阅读与朗读,P3,done,codex,flutter test test/reader_search_navigation_helper_test.dart 与 flutter test test/reader_top_menu_test.dart 通过；手工路径: 阅读页->搜索正文->输入关键词->搜索->上一个/下一个命中,将全文搜索从“仅当前章节命中”收敛为 legado 同义“跨章节命中列表 + 跨章节跳转”；保持在线书仅检索已缓存章节并在搜索面板展示章节维度结果信息
211,content_select_action.xml,@+id/menu_browser,@string/browser,浏览器,阅读与朗读,P3,done,codex,手工路径: 阅读页(翻页模式)->长按正文词句->文本操作->浏览器; 校验选中文本为http或https时外部浏览器直开且失败提示ERROR; 非网址文本按关键词发起网页搜索,对齐legado TextActionMenu.menu_browser语义：选中文本为绝对网址时走ACTION_VIEW; 非绝对网址时走ACTION_WEB_SEARCH; 异常提示localizedMessage为空时回退ERROR
212,content_select_action.xml,@+id/menu_share_str,@string/share,分享,阅读与朗读,P3,done,codex,手工路径: 阅读页(翻页模式)->长按正文词句->文本操作->分享; 校验打开系统分享面板且分享内容为选中文本并且不追加成功或失败提示,对齐 legado TextActionMenu.menu_share_str：补齐文本操作“分享”入口；点击后调用系统文本分享（subject=分享 且 text=selectedText）；分享异常静默吞掉不追加提示
215,dict_rule.xml,@+id/menu_add,@string/create,新建,规则与净化,P5,done,codex,命令: dart format lib/features/reader/views/dict_rule_manage_view.dart；flutter test test/simple_reader_view_compile_test.dart test/widget_test.dart 通过；手工路径（待回归）: 设置->源管理->替换净化->字典规则->右上角加号->进入字典规则编辑页; 校验点击后打开空白编辑页且不自动保存,对齐 legado DictRuleActivity.menu_add 语义: 顶栏一级新建入口点击后仅打开空白字典规则编辑页；不触发导入链路且不自动落库
216,dict_rule.xml,@+id/menu_import_local,@string/import_local,本地导入,规则与净化,P5,done,codex,手工路径: 设置->源管理->替换净化->字典规则->右上角更多->本地导入->选择txt/json->勾选候选->导入; 校验候选列表显示新增/已有且默认仅勾选新增；确认后按名称覆盖写入并返回列表可见,对齐 legado DictRuleActivity.menu_import_local 语义: 仅允许txt/json本地文件导入；导入前展示候选并按本地同名规则标记新增/已有；默认勾选新增并仅导入勾选项
217,dict_rule.xml,@+id/menu_import_onLine,@string/import_on_line,网络导入,规则与净化,P5,done,codex,手工路径: 设置->源管理->替换净化->字典规则->右上角更多->网络导入->输入URL并导入; 校验URL可进入候选列表且默认仅勾选新增；确认后按名称覆盖写入并刷新列表；历史记录支持点选回填与删除,对齐 legado DictRuleActivity.menu_import_onLine 语义: 网络导入先弹URL输入层并维护 dictRuleUrls 历史；确认后进入导入字典规则候选弹层；仅导入勾选项并保持新增默认选中
218,dict_rule.xml,@+id/menu_import_qr,@string/import_by_qr_code,二维码导入,规则与净化,P5,done,codex,手工路径: 设置->源管理->替换净化->字典规则->右上角更多->二维码导入->扫码导入; 校验扫码结果可进入候选列表且默认仅勾选新增；确认后按名称覆盖写入并刷新列表；扫码取消或空结果静默返回,对齐 legado DictRuleActivity.menu_import_qr 语义: 点击后仅拉起扫码并将扫码文本直接交给导入字典规则候选弹层；候选状态与默认勾选规则保持新增优先；二维码导入不写入 dictRuleUrls 网络历史
219,dict_rule.xml,@+id/menu_import_default,@string/import_default_rule,导入默认规则,规则与净化,P5,done,codex,flutter test test/simple_reader_view_compile_test.dart 与 flutter test test/widget_test.dart 通过；手工路径: 设置->源管理->替换净化->字典规则->右上角更多->导入默认规则；校验默认规则按名称覆盖写入且列表刷新；重复导入不清理非默认规则,对齐 legado DictRuleActivity.menu_import_default 语义: 点击后直接导入默认字典规则；导入行为按 name 覆盖写入（REPLACE）并保留非同名本地规则；不追加成功提示
221,dict_rule_edit.xml,@+id/menu_save,@string/action_save,保存,规则与净化,P5,done,codex,命令: dart format lib/features/reader/views/dict_rule_edit_view.dart lib/features/reader/views/dict_rule_manage_view.dart lib/features/reader/services/dict_rule_store.dart；手工路径（待回归）: 设置->源管理->替换净化->字典规则->右上角加号->填写名称/URL规则/显示规则->保存；手工路径（待回归）: 设置->源管理->替换净化->字典规则->点击已有规则->修改名称后保存,对齐 legado DictRuleEditDialog.menu_save 语义: 编辑页提供顶栏一级保存入口；保存时仅提交 name/urlRule/showRule 并保留 enabled/sortNumber；管理页按“删除旧名再按新名写入”刷新规则列表；保存成功不追加扩展提示
223,dict_rule_edit.xml,@+id/menu_paste_rule,@string/paste_rule,粘贴规则,规则与净化,P5,done,codex,flutter test test/simple_reader_view_compile_test.dart 通过；手工路径: 设置->源管理->替换净化->字典规则->任一规则->更多->粘贴规则; 校验剪贴板为空提示“剪贴板没有内容”，非法JSON提示“格式不对”，合法JSON对象仅回填名称/URL规则/显示规则且不自动保存,对齐 legado DictRuleEditDialog.menu_paste_rule 语义: 读取剪贴板文本后按 DictRule JSON 对象解析；成功仅执行 upRuleView 回填编辑表单；失败分支提示固定口径且不触发保存
224,dict_rule_sel.xml,@+id/menu_enable_selection,@string/enable_selection,启用所选,规则与净化,P5,done,codex,命令: dart format lib/features/reader/services/dict_rule_store.dart lib/features/reader/views/dict_rule_manage_view.dart；手工路径（待回归）: 设置->源管理->替换净化->字典规则->多选->勾选至少一条禁用规则->更多->启用所选; 校验所选规则 enabled 置为 true 且“禁用”标记消失并保持静默不提示,对齐 legado DictRuleActivity.menu_enable_selection 语义: 多选菜单“启用所选”仅对当前选中集合批量写入 enabled=true 并刷新列表；不追加成功提示且保持页面停留
225,dict_rule_sel.xml,@+id/menu_disable_selection,@string/disable_selection,禁用所选,规则与净化,P5,done,codex,命令: dart format lib/features/reader/views/dict_rule_manage_view.dart；手工路径（待回归）: 设置->源管理->替换净化->字典规则->多选->勾选至少一条启用规则->更多->禁用所选; 校验所选规则 enabled 置为 false 且“禁用”标记出现并保持静默不提示,对齐 legado DictRuleActivity.menu_disable_selection 语义: 多选菜单“禁用所选”仅对当前选中集合批量写入 enabled=false 并刷新列表；不追加成功提示且保持页面停留
226,dict_rule_sel.xml,@+id/menu_export_selection,@string/export_selection,导出所选,规则与净化,P5,done,codex,手工路径: 设置->源管理->替换净化->字典规则->多选->勾选规则->更多->导出所选; 校验默认文件名 exportDictRule.json 且取消导出静默返回并在成功后弹出路径可复制,对齐 legado DictRuleActivity.menu_export_selection 语义: 仅导出当前选中规则为 JSON 数组；导出成功后展示路径并支持复制
228,direct_link_upload_config.xml,@+id/menu_paste_rule,@string/paste_rule,粘贴规则,导入导出与备份,P8,done,codex,命令: dart format lib/features/settings/models/direct_link_upload_rule.dart lib/features/settings/services/direct_link_upload_config_service.dart lib/features/settings/views/direct_link_upload_config_view.dart lib/features/settings/views/other_settings_view.dart；手工路径（待回归）: 设置->其它设置->源设置->直链上传规则->右上角更多->粘贴规则；校验合法 JSON 对象仅回填上传URL和下载URL规则和注释和是否压缩，空剪贴板或非法 JSON 提示“剪贴板为空或格式不对”且不自动保存,对齐 legado DirectLinkUploadConfig.menu_paste_rule 语义: 读取剪贴板文本并按 Rule JSON 对象解析；成功仅执行 upView 回填表单；失败统一提示“剪贴板为空或格式不对”，不触发保存与跳转
229,direct_link_upload_config.xml,@+id/menu_import_default,@string/import_default_rule,导入默认规则,导入导出与备份,P8,done,codex,命令: dart format lib/features/settings/models/direct_link_upload_rule.dart lib/features/settings/services/direct_link_upload_config_service.dart lib/features/settings/views/direct_link_upload_config_view.dart lib/features/settings/views/other_settings_view.dart；手工路径（待回归）: 设置->其它设置->源设置->直链上传规则->右上角更多->导入默认规则->选择任一默认规则；校验仅回填上传URL和下载URL规则和注释和是否压缩且页面保持停留不自动保存,对齐 legado DirectLinkUploadConfig.menu_import_default 语义: 弹出默认规则选择器并展示 defaultRules；选中后仅执行 upView 回填当前表单，不触发保存与关闭
241,import_book.xml,@+id/menu_select_folder,@string/select_folder,选择文件夹,导入导出与备份,P8,done,codex,命令: dart format lib/features/import/import_service.dart lib/features/bookshelf/views/bookshelf_view.dart；手工路径（待回归）: 书架->更多->选择文件夹->选择任一可访问目录；书架->更多->添加本地->打开文件选择器；校验选择文件夹仅保存目录且取消静默返回，后续添加本地默认从已选目录打开,对齐 legado ImportBookActivity.menu_select_folder 语义: 书架“更多”菜单补齐同层级“选择文件夹”入口；点击后拉起目录选择并仅保存 importBookPath，取消不覆盖历史目录；后续本地导入文件选择默认复用该目录，非法目录/异常保持可观测失败提示并不覆盖旧值
246,import_book.xml,@+id/menu_scan_folder,@string/scan_folder,智能扫描,导入导出与备份,P8,done,codex,命令: dart format lib/features/import/import_service.dart lib/features/bookshelf/views/bookshelf_view.dart；命令: dart analyze lib/features/import/import_service.dart lib/features/bookshelf/views/bookshelf_view.dart；手工路径（待回归）: 书架->更多->智能扫描->勾选文件->导入；校验扫描仅覆盖已选目录及子目录下 txt/epub 并支持勾选导入与失败明细,对齐 legado ImportBookActivity.menu_scan_folder 语义: 书架“更多”菜单补齐同层级“智能扫描”入口；点击后递归扫描 importBookPath 目录及子目录并展示候选列表；确认后仅导入已勾选项并汇总成功/失败结果，取消保持静默
247,import_book.xml,@+id/menu_import_file_name,@string/import_file_name,导入文件名,导入导出与备份,P8,done,codex,命令: dart format lib/features/import/book_import_file_name_rule_service.dart lib/features/import/import_service.dart lib/features/bookshelf/views/bookshelf_view.dart；手工路径（待回归）: 书架->更多->导入文件名->输入规则并确定；书架->更多->添加本地->选择 txt 或 epub；校验规则持久化且导入时按 src 变量解析 name author,对齐 legado ImportBookActivity.menu_import_file_name 语义: 新增同层级“导入文件名”入口并弹出 JS 输入框提示“使用js处理文件名变量src，将书名作者分别赋值到变量name author”；点击确定仅保存 bookImportFileName；后续本地导入按规则覆盖 name author，规则异常记录日志并回退默认命名
248,import_book_sel.xml,@+id/menu_del_selection,@string/delete,删除,导入导出与备份,P8,done,codex,命令: dart format lib/features/import/import_service.dart lib/features/bookshelf/views/bookshelf_view.dart；命令: dart analyze lib/features/import/import_service.dart lib/features/bookshelf/views/bookshelf_view.dart；手工路径（待回归）: 书架->更多->智能扫描->勾选若干文件->删除；校验仅删除已勾选文件且候选项即时移除并保持静默,对齐 legado ImportBookActivity.menu_del_selection 语义: 智能扫描候选弹层补齐“删除”动作；触发后按当前勾选集合执行文件删除并在动作结束后从候选列表移除所选项；删除流程不追加成功提示，导入与删除分流保持独立
281,replace_edit.xml,@+id/menu_save,@string/action_save,保存,规则与净化,P5,done,codex,命令: dart format lib/features/replace/models/replace_rule.dart lib/features/replace/views/replace_rule_edit_view.dart lib/features/replace/views/replace_rule_list_view.dart lib/features/reader/views/simple_reader_view.dart；flutter test test/search_view_compile_test.dart test/simple_reader_view_compile_test.dart 通过；手工路径（待回归）: 设置->源管理->替换净化->文本替换规则->编辑任一规则->右上角保存；校验无效规则提示 save error 且保存失败不退出页面,对齐 legado ReplaceEditActivity.menu_save 语义: 点击保存先执行规则有效性校验；order 为 Int.MIN_VALUE 时按 maxOrder+1 分配；保存成功关闭编辑页且不提示成功；保存失败提示 save error 并停留当前页
283,replace_edit.xml,@+id/menu_paste_rule,@string/paste_rule,粘贴规则,规则与净化,P5,done,codex,命令: dart format lib/features/replace/views/replace_rule_edit_view.dart；手工路径: 设置->源管理->替换净化->文本替换规则->编辑任一规则->右上角更多->粘贴规则; 校验空剪贴板提示“剪贴板为空”且非法JSON提示“格式不对”，合法JSON对象仅回填编辑表单并停留当前页不自动保存,对齐 legado ReplaceEditActivity.menu_paste_rule 语义: 粘贴入口位于编辑页更多菜单；剪贴板解析成功仅执行 upReplaceView 等价表单回填；失败分支固定口径提示且不触发保存与跳转
293,replace_rule_item.xml,@+id/menu_bottom,@string/to_bottom,置底,规则与净化,P5,done,codex,命令: dart format lib/features/replace/views/replace_rule_list_view.dart；flutter test test/search_view_compile_test.dart test/widget_test.dart 通过,手工路径: 设置->源管理->替换净化->文本替换规则->任一规则右侧更多->置底；校验目标规则后移且无成功提示；对齐 legado ReplaceRuleActivity.menu_bottom 与 ReplaceRuleViewModel.toBottom 的静默置底语义
294,replace_rule_item.xml,@+id/menu_del,@string/delete,删除,规则与净化,P5,done,codex,命令: dart format lib/features/replace/views/replace_rule_list_view.dart；flutter test test/search_view_compile_test.dart test/widget_test.dart 通过,手工路径: 设置->源管理->替换净化->文本替换规则->任一规则右侧更多->删除->取消/确定；校验菜单含删除入口、弹出“提醒 + 是否确认删除？\\n规则名”确认框、确认后删除并刷新且无成功提示；对齐 legado ReplaceRuleAdapter.menu_del 与 ReplaceRuleActivity.delete 的删除确认语义
295,replace_rule_sel.xml,@+id/menu_enable_selection,@string/enable_selection,启用所选,规则与净化,P5,done,codex,命令: dart format lib/features/replace/views/replace_rule_list_view.dart；flutter test test/search_view_compile_test.dart test/widget_test.dart 通过,手工路径: 设置->源管理->替换净化->文本替换规则->多选->勾选至少一条禁用规则->更多->启用所选；校验仅所选规则 enabled 置为 true 且列表保持当前页静默刷新；对齐 legado ReplaceRuleActivity.menu_enable_selection 与 ReplaceRuleViewModel.enableSelection 的批量启用语义
296,replace_rule_sel.xml,@+id/menu_disable_selection,@string/disable_selection,禁用所选,规则与净化,P5,done,codex,命令: dart format lib/features/replace/views/replace_rule_list_view.dart；flutter test test/search_view_compile_test.dart test/widget_test.dart 通过,手工路径: 设置->源管理->替换净化->文本替换规则->多选->勾选至少一条启用规则->更多->禁用所选；校验仅所选规则 enabled 置为 false 且列表保持当前页静默刷新；对齐 legado ReplaceRuleActivity.menu_disable_selection 与 ReplaceRuleViewModel.disableSelection 的批量禁用语义
297,replace_rule_sel.xml,@+id/menu_top_sel,@string/selection_to_top,置顶所选,规则与净化,P5,done,codex,命令: dart format lib/features/replace/views/replace_rule_list_view.dart；flutter test test/search_view_compile_test.dart test/widget_test.dart 通过,手工路径: 设置->源管理->替换净化->文本替换规则->多选->勾选至少两条规则->更多->置顶所选；校验所选规则按当前列表顺序批量上移到顶部且无成功提示；对齐 legado ReplaceRuleActivity.menu_top_sel 与 ReplaceRuleViewModel.topSelect 的静默批量置顶语义
298,replace_rule_sel.xml,@+id/menu_bottom_sel,@string/selection_to_bottom,置底所选,规则与净化,P5,done,codex,命令: dart format lib/features/replace/views/replace_rule_list_view.dart；flutter test test/search_view_compile_test.dart test/widget_test.dart 通过,手工路径: 设置->源管理->替换净化->文本替换规则->多选->勾选至少两条规则->更多->置底所选；校验所选规则按当前列表顺序批量下移到底部且无成功提示；对齐 legado ReplaceRuleActivity.menu_bottom_sel 与 ReplaceRuleViewModel.bottomSelect 的静默批量置底语义
349,server_config.xml,@+id/menu_save,@string/action_save,保存,导入导出与备份,P8,done,codex,命令: dart format lib/features/bookshelf/views/remote_books_server_config_view.dart；手工路径（待回归）: 书架->更多->远程书籍->更多->服务器配置->新建或编辑服务器->修改名称或地址或账号或密码->右上角保存；校验仅在点击顶栏保存后写入服务器列表并关闭页面；手工路径（待回归）: 同页面修改后直接返回上一页；校验草稿不落盘,对齐 legado ServerConfigDialog.menu_save 语义: 配置页采用草稿态编辑并由顶栏一级“保存”统一提交；保存成功静默关闭页面且不自动切换当前选中服务器；保存失败提示“保存出错\\n<原因>”
350,servers.xml,@+id/menu_add,@string/create,新建,导入导出与备份,P8,done,codex,命令: dart format lib/features/bookshelf/models/remote_server.dart lib/features/bookshelf/services/remote_server_store.dart lib/features/bookshelf/views/remote_books_server_config_view.dart lib/features/bookshelf/views/remote_books_servers_view.dart lib/features/bookshelf/views/remote_books_placeholder_view.dart；手工路径（待回归）: 书架->更多->远程书籍->更多->服务器配置->右上角新建->填写名称地址账号密码->保存；校验保存后返回服务器列表且新增条目可见,对齐 legado ServersDialog.menu_add 语义: 服务器配置列表页补齐顶栏一级“新建”入口；点击后打开服务器配置编辑页并保存到服务器列表；不自动改写当前选中服务器，需通过“默认/取消/确定”底部动作确认选择
387,txt_toc_rule.xml,@+id/menu_add,@string/add,添加,规则与净化,P5,done,codex,命令: dart format lib/features/reader/services/txt_toc_rule_store.dart lib/features/reader/views/txt_toc_rule_manage_view.dart lib/features/reader/views/txt_toc_rule_edit_view.dart；手工路径（待回归）: 设置->源管理->目录规则->右上角添加->填写名称与正则->保存；校验新增规则落库并显示在列表且名称为空提示“名称不能为空”且非法正则提示“正则语法错误或不支持(txt)：...”；按仓库约束开发阶段未执行 flutter analyze,对齐 legado TxtTocRuleActivity.menu_add 与 TxtTocRuleEditDialog.menu_save 语义: 顶栏新增“添加”一级入口；点击后进入规则编辑页；保存前校验名称与正则；仅保存成功回写规则并刷新列表
393,txt_toc_rule_edit.xml,@+id/menu_save,@string/action_save,保存,规则与净化,P5,done,codex,命令: dart format lib/features/reader/views/txt_toc_rule_edit_view.dart；手工路径（待回归）: 设置->源管理->目录规则->点击任一规则->修改名称/正则/示例后保存；清空示例后保存；校验保存后列表刷新且示例可被清空且不追加成功提示,对齐 legado TxtTocRuleEditDialog.menu_save 语义: 顶栏一级保存入口仅在校验通过后回传并关闭编辑页；保存提交字段仅 name/rule/example 并保留 id/enabled/serialNumber；修复示例清空无法保存的问题以贴齐 toString 空串写回边界
396,txt_toc_rule_item.xml,@+id/menu_top,@string/to_top,置顶,规则与净化,P5,done,codex,命令: dart format lib/features/reader/services/txt_toc_rule_store.dart lib/features/reader/views/txt_toc_rule_manage_view.dart；flutter test test/simple_reader_view_compile_test.dart test/search_book_info_view_compile_test.dart 通过；手工路径（待回归）: 设置->源管理->目录规则->任一规则右侧更多->置顶；校验目标规则移动到列表顶部且无成功提示；按仓库约束开发阶段未执行 flutter analyze,对齐 legado TxtTocRuleAdapter.showMenu(menu_top) 与 TxtTocRuleViewModel.toTop 语义: 条目更多菜单新增“置顶”入口；点击后将目标规则 serialNumber 写为当前最小值减一并静默刷新列表
397,txt_toc_rule_item.xml,@+id/menu_bottom,@string/to_bottom,置底,规则与净化,P5,done,codex,命令: dart format lib/features/reader/services/txt_toc_rule_store.dart lib/features/reader/views/txt_toc_rule_manage_view.dart；flutter test test/simple_reader_view_compile_test.dart test/search_book_info_view_compile_test.dart 通过；手工路径（待回归）: 设置->源管理->目录规则->任一规则右侧更多->置底；校验目标规则移动到列表底部且无成功提示；按仓库约束开发阶段未执行 flutter analyze,对齐 legado TxtTocRuleAdapter.showMenu(menu_bottom) 与 TxtTocRuleViewModel.toBottom 语义: 条目更多菜单新增“置底”入口；点击后将目标规则 serialNumber 写为当前最大值加一并静默刷新列表
398,txt_toc_rule_item.xml,@+id/menu_del,@string/delete,删除,规则与净化,P5,done,codex,命令: dart format lib/features/reader/services/txt_toc_rule_store.dart lib/features/reader/views/txt_toc_rule_manage_view.dart；flutter test test/simple_reader_view_compile_test.dart test/search_book_info_view_compile_test.dart 通过；手工路径（待回归）: 设置->源管理->目录规则->任一规则右侧更多->删除->取消/确定；校验先移除当前选中态后弹出“提醒/是否确认删除？\\n规则名”，取消不删库、确认后条目移除且无成功提示；按仓库约束开发阶段未执行 flutter analyze,对齐 legado TxtTocRuleAdapter.showMenu(menu_del) 与 TxtTocRuleActivity.del 语义: 条目更多菜单新增“删除”入口；触发顺序保持“先移除选中态再弹确认框”；仅确认后删库并静默刷新列表
399,txt_toc_rule_sel.xml,@+id/menu_enable_selection,@string/enable_selection,启用所选,规则与净化,P5,done,codex,命令: dart format lib/features/reader/services/txt_toc_rule_store.dart lib/features/reader/views/txt_toc_rule_manage_view.dart；flutter test test/simple_reader_view_compile_test.dart test/search_book_info_view_compile_test.dart 通过；手工路径（待回归）: 设置->源管理->目录规则->多选->勾选至少一条禁用规则->更多->启用所选；校验仅选中规则 enabled 置为 true 且列表保持静默刷新无成功提示；按仓库约束开发阶段未执行 flutter analyze,对齐 legado TxtTocRuleActivity.menu_enable_selection 与 TxtTocRuleViewModel.enableSelection 语义: 多选菜单“启用所选”仅对当前选中集合批量写入 enable=true 并刷新列表；不追加成功提示且保持页面停留
400,txt_toc_rule_sel.xml,@+id/menu_disable_selection,@string/disable_selection,禁用所选,规则与净化,P5,done,codex,命令: dart format lib/features/reader/services/txt_toc_rule_store.dart lib/features/reader/views/txt_toc_rule_manage_view.dart；flutter test test/simple_reader_view_compile_test.dart test/search_book_info_view_compile_test.dart 通过；手工路径（待回归）: 设置->源管理->目录规则->多选->勾选至少一条启用规则->更多->禁用所选；校验仅选中规则 enabled 置为 false 且列表保持静默刷新无成功提示；按仓库约束开发阶段未执行 flutter analyze,对齐 legado TxtTocRuleActivity.menu_disable_selection 与 TxtTocRuleViewModel.disableSelection 语义: 多选菜单“禁用所选”仅对当前选中集合批量写入 enable=false 并刷新列表；不追加成功提示且保持页面停留
