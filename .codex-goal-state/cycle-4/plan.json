{"done":false,"done_reason":"目标未完成：当前核心壳层与四个核心页仍未接入 iOS 大标题导航（`CupertinoSliverNavigationBar` 相关命中为 0），`N-PRE-01`、`N-01~N-04`、`N-VAL-01` 仍为 pending。","goal_summary":"第4轮聚焦 AGENTS.md 的 UI 强约束落地：先完成通用壳层大标题能力，再迁移书架/发现/订阅/我的四个核心页，最后回填台账与回归记录。","tasks":[{"id":"R4-T01","title":"实现通用壳层大标题导航能力（N-PRE-01）","priority":1,"prompt":"改动范围：`lib/app/widgets/app_cupertino_page_scaffold.dart`。在现有 `AppCupertinoPageScaffold` 上新增可选大标题模式（建议参数：`useSliverNavigationBar`、`largeTitle`、`sliverBodyBuilder` 或同义命名），内部支持 `CupertinoSliverNavigationBar + CustomScrollView`，同时保留旧的 `CupertinoNavigationBar` 路径以兼容非迁移页面。预期行为：默认调用不受影响；开启大标题模式后首屏展示 large title，滚动时可折叠为 inline 标题，且顶部/底部 SafeArea 与现有背景语义保持一致。验证方式：1) `dart format` 通过；2) 代码中存在明确的大标题分支与旧分支共存；3) 不改动业务页面也可编译通过该组件调用。","verify_cmd":"dart format --set-exit-if-changed lib/app/widgets/app_cupertino_page_scaffold.dart && rg -n \"CupertinoSliverNavigationBar|useSliverNavigationBar|largeTitle|CustomScrollView\" lib/app/widgets/app_cupertino_page_scaffold.dart","required_paths":["lib/app/widgets/app_cupertino_page_scaffold.dart"],"depends_on":[]},{"id":"R4-T02","title":"书架页接入大标题导航（N-01）","priority":2,"prompt":"改动范围：`lib/features/bookshelf/views/bookshelf_view.dart`（必要时联动 `lib/app/widgets/app_cupertino_page_scaffold.dart` 的新参数调用）。将书架根页改为使用 R4-T01 的大标题能力，保持现有顶部操作（搜索、更多菜单）、书籍列表/空态/错误态与重选回顶逻辑不变。预期行为：书架页首屏显示大标题“书架”，上滑折叠稳定；`reselectSignal` 触发回顶后标题恢复展开；从书架进入阅读页再返回，导航与状态不回退。验证方式：1) `dart format` 通过；2) 页面代码已启用大标题参数或 sliver 导航路径；3) 手工回归 R-N01（滚动折叠、点击书籍进入阅读、返回后状态正常）。","verify_cmd":"dart format --set-exit-if-changed lib/features/bookshelf/views/bookshelf_view.dart && rg -n \"useSliverNavigationBar|largeTitle|CupertinoSliverNavigationBar\" lib/features/bookshelf/views/bookshelf_view.dart","required_paths":["lib/features/bookshelf/views/bookshelf_view.dart","lib/app/widgets/app_cupertino_page_scaffold.dart"],"depends_on":["R4-T01"]},{"id":"R4-T03","title":"发现页接入大标题导航（N-02）","priority":3,"prompt":"改动范围：`lib/features/discovery/views/discovery_view.dart`（必要时联动壳层参数）。把发现页根容器切换到大标题导航语义，保留分组筛选、搜索、展开/收起、进入二级发现页等现有交互链路不变。预期行为：首屏显示大标题“发现”，滚动/回弹时折叠状态稳定不抖动；`compressSignal` 回顶后大标题恢复展开；进入详情后返回列表状态保持。验证方式：1) `dart format` 通过；2) 页面已接入大标题参数或 sliver 导航；3) 手工回归 R-N02（滚动折叠、进入详情再返回、侧滑返回正常）。","verify_cmd":"dart format --set-exit-if-changed lib/features/discovery/views/discovery_view.dart && rg -n \"useSliverNavigationBar|largeTitle|CupertinoSliverNavigationBar\" lib/features/discovery/views/discovery_view.dart","required_paths":["lib/features/discovery/views/discovery_view.dart","lib/app/widgets/app_cupertino_page_scaffold.dart"],"depends_on":["R4-T01"]},{"id":"R4-T04","title":"订阅页接入大标题导航（N-03）","priority":4,"prompt":"改动范围：`lib/features/rss/views/rss_subscription_view.dart`（必要时联动壳层参数）。将订阅页根容器改为大标题导航，保持搜索、规则订阅入口、分组菜单、来源列表与操作菜单行为一致。预期行为：首屏显示大标题“订阅”，滚动后折叠稳定；进入订阅源详情或规则订阅页后返回，列表筛选状态与滚动语义不异常。验证方式：1) `dart format` 通过；2) 页面已接入大标题参数或 sliver 导航；3) 手工回归 R-N03（滚动折叠、订阅项点击、返回状态保持）。","verify_cmd":"dart format --set-exit-if-changed lib/features/rss/views/rss_subscription_view.dart && rg -n \"useSliverNavigationBar|largeTitle|CupertinoSliverNavigationBar\" lib/features/rss/views/rss_subscription_view.dart","required_paths":["lib/features/rss/views/rss_subscription_view.dart","lib/app/widgets/app_cupertino_page_scaffold.dart"],"depends_on":["R4-T01"]},{"id":"R4-T05","title":"我的页接入大标题导航（N-04）","priority":5,"prompt":"改动范围：`lib/features/settings/views/settings_view.dart`（必要时联动壳层参数）。将“我的/设置”根页接入大标题导航，保持当前菜单分组、入口顺序、Web 服务占位提示与二级页跳转语义不变。预期行为：首屏显示大标题“我的”，滚动折叠行为稳定；从“我的”进入任意二级页面后仍支持 iOS 侧滑返回；根页不出现误 pop。验证方式：1) `dart format` 通过；2) 页面已接入大标题参数或 sliver 导航；3) 手工回归 R-N04（滚动折叠、二级页返回、侧滑返回能力）。","verify_cmd":"dart format --set-exit-if-changed lib/features/settings/views/settings_view.dart && rg -n \"useSliverNavigationBar|largeTitle|CupertinoSliverNavigationBar\" lib/features/settings/views/settings_view.dart","required_paths":["lib/features/settings/views/settings_view.dart","lib/app/widgets/app_cupertino_page_scaffold.dart"],"depends_on":["R4-T01"]},{"id":"R4-T06","title":"回填台账与依赖收口（N-VAL-01）","priority":6,"prompt":"改动范围：`docs/plans/2026-02-27-ui-cupertino-diff.md`、`PLANS.md`。基于 R4-T01~R4-T05 实际代码结果，回填 `N-01~N-04` 与 `N-PRE-01` 状态、排版布局一致性结论、手工回归记录，并更新执行依赖到 `N-VAL-01` 收口状态。预期行为：文档状态与代码一致，不使用“完全一致”绝对措辞；若存在未等价点，按 AGENTS 1.1.2 补齐 blocked 记录（原因/影响/替代/回补计划）。验证方式：1) 文档内 `N-PRE-01`、`N-01~N-04`、`N-VAL-01` 状态与代码检索一致；2) `PLANS.md` 依赖链与并行/串行关系更新完整。","verify_cmd":"rg -n \"N-PRE-01|N-01|N-02|N-03|N-04|N-VAL-01|blocked|EX-NAV-01\" docs/plans/2026-02-27-ui-cupertino-diff.md PLANS.md && rg -n \"useSliverNavigationBar|largeTitle|CupertinoSliverNavigationBar\" lib/features/bookshelf/views/bookshelf_view.dart lib/features/discovery/views/discovery_view.dart lib/features/rss/views/rss_subscription_view.dart lib/features/settings/views/settings_view.dart lib/app/widgets/app_cupertino_page_scaffold.dart","required_paths":["docs/plans/2026-02-27-ui-cupertino-diff.md","PLANS.md","lib/app/widgets/app_cupertino_page_scaffold.dart","lib/features/bookshelf/views/bookshelf_view.dart","lib/features/discovery/views/discovery_view.dart","lib/features/rss/views/rss_subscription_view.dart","lib/features/settings/views/settings_view.dart"],"depends_on":["R4-T02","R4-T03","R4-T04","R4-T05"]}],"notes":["并行建议：R4-T02/R4-T03/R4-T04/R4-T05 可并行；R4-T01 与 R4-T06 串行。","本轮验证按 AGENTS 要求使用定向检索 + `dart format` + 手工回归记录，不使用 `flutter analyze`。"]}