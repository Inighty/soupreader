{"done":false,"done_reason":"目标尚未完成：当前代码侧的 Cupertino 迁移基本到位，但 `N-VAL-01` 仍停留在 `blocked`，且缺少能区分“结构通过”与“可发布通过”的自动化门禁，导致 UI 收口状态无法稳定判定。","goal_summary":"下一批任务聚焦“把导航回归收口做成可执行门禁链路”：先补脚本能力（严格区分 blocked/done），再标准化证据文档字段，最后统一台账状态与一键校验入口。","tasks":[{"id":"R8-T1","title":"增强导航证据守卫脚本，增加发布级校验模式","priority":1,"prompt":"改动范围：`tool/ui_nav_regression_guard.sh`。在现有 `--mode=structure|strict` 基础上新增 `--mode=release`：除字段完整性外，还必须校验四份证据文件的“结果”字段为 `done`（或约定的通过态），并拒绝 `blocked`/`pending`/`active` 等未收口状态；同时保持 `structure` 与 `strict` 现有行为不回退。预期行为：开发阶段可用 `structure/strict`，收口阶段用 `release` 一次性判断是否可宣告 UI 导航专项完成。验证方式：1) `bash tool/ui_nav_regression_guard.sh --mode=structure` 通过；2) 当前证据仍为 blocked 时 `bash tool/ui_nav_regression_guard.sh --mode=release` 返回非 0 且指出失败文件/字段。","verify_cmd":"bash tool/ui_nav_regression_guard.sh --mode=structure && (bash tool/ui_nav_regression_guard.sh --mode=release; test $? -ne 0)","required_paths":["tool/ui_nav_regression_guard.sh","docs/plans/evidence/2026-02-27-ui-nav-final-regression/R-N01-bookshelf.md","docs/plans/evidence/2026-02-27-ui-nav-final-regression/R-N02-discovery.md","docs/plans/evidence/2026-02-27-ui-nav-final-regression/R-N03-rss.md","docs/plans/evidence/2026-02-27-ui-nav-final-regression/R-N04-settings.md"],"depends_on":[]},{"id":"R8-T2","title":"新增导航证据命中行号同步脚本，消除文档与代码行号漂移","priority":2,"prompt":"改动范围：新增 `tool/ui_nav_evidence_sync.sh`，并按需小改 `tool/ui_nav_regression_guard.sh`。脚本读取四个核心页文件中 `useSliverNavigationBar: true` 的当前命中行号，自动回写到 `R-N01~R-N04` 的“命中摘要”字段；当字段缺失或格式不符时给出明确报错。预期行为：每次 UI 代码改动后可一键同步证据文档，避免手工维护行号导致假通过。验证方式：1) 运行同步脚本后，`rg -n \"命中摘要\" docs/plans/evidence/2026-02-27-ui-nav-final-regression/R-N0*.md` 显示 4 条且均包含对应 view 文件名；2) `bash tool/ui_nav_regression_guard.sh --mode=strict` 继续通过。","verify_cmd":"bash tool/ui_nav_evidence_sync.sh && rg -n \"命中摘要: `.*(bookshelf_view|discovery_view|rss_subscription_view|settings_view)\\.dart:[0-9]+`\" docs/plans/evidence/2026-02-27-ui-nav-final-regression/R-N0*.md && bash tool/ui_nav_regression_guard.sh --mode=strict","required_paths":["tool/ui_nav_evidence_sync.sh","tool/ui_nav_regression_guard.sh","docs/plans/evidence/2026-02-27-ui-nav-final-regression/R-N01-bookshelf.md","docs/plans/evidence/2026-02-27-ui-nav-final-regression/R-N02-discovery.md","docs/plans/evidence/2026-02-27-ui-nav-final-regression/R-N03-rss.md","docs/plans/evidence/2026-02-27-ui-nav-final-regression/R-N04-settings.md"],"depends_on":["R8-T1"]},{"id":"R8-T3","title":"统一导航证据文档字段为可机检格式","priority":3,"prompt":"改动范围：`docs/plans/evidence/2026-02-27-ui-nav-final-regression/R-N01-bookshelf.md`、`R-N02-discovery.md`、`R-N03-rss.md`、`R-N04-settings.md`。将“排版布局一致性结论”从步骤描述中抽出为独立字段（例如 `- 排版布局一致性:`），并统一“结果/处理动作”字段枚举值格式（done/blocked/pending）；与守卫脚本字段列表保持一致。预期行为：证据文档可被脚本稳定解析，不再依赖自然语言段落推断状态。验证方式：1) 四份证据均含独立 `排版布局一致性` 字段；2) `bash tool/ui_nav_regression_guard.sh --mode=strict` 通过；3) `--mode=release` 在 blocked 状态下仍按预期失败。","verify_cmd":"rg -n \"^- 排版布局一致性:\" docs/plans/evidence/2026-02-27-ui-nav-final-regression/R-N0*.md && bash tool/ui_nav_regression_guard.sh --mode=strict && (bash tool/ui_nav_regression_guard.sh --mode=release; test $? -ne 0)","required_paths":["docs/plans/evidence/2026-02-27-ui-nav-final-regression/R-N01-bookshelf.md","docs/plans/evidence/2026-02-27-ui-nav-final-regression/R-N02-discovery.md","docs/plans/evidence/2026-02-27-ui-nav-final-regression/R-N03-rss.md","docs/plans/evidence/2026-02-27-ui-nav-final-regression/R-N04-settings.md","tool/ui_nav_regression_guard.sh"],"depends_on":["R8-T2"]},{"id":"R8-T4","title":"新增 UI 收口总控脚本，串联 Cupertino 静态门禁与导航证据门禁","priority":4,"prompt":"改动范围：新增 `tool/ui_goal_gate.sh`。脚本按顺序执行 `tool/ui_cupertino_guard.sh` 与 `tool/ui_nav_regression_guard.sh`（默认 `--mode=strict`，可通过参数切换 `--release` 触发 release 门禁），并输出统一汇总结果与退出码。预期行为：后续每轮只需运行一个命令即可判断“UI 代码基线是否健康 + 导航证据是否达标”，避免多脚本人工拼接。验证方式：1) `bash tool/ui_goal_gate.sh` 在当前仓库返回 0（strict 模式）；2) `bash tool/ui_goal_gate.sh --release` 在证据 blocked 时返回非 0。","verify_cmd":"bash tool/ui_goal_gate.sh && (bash tool/ui_goal_gate.sh --release; test $? -ne 0)","required_paths":["tool/ui_goal_gate.sh","tool/ui_cupertino_guard.sh","tool/ui_nav_regression_guard.sh"],"depends_on":["R8-T1","R8-T3"]},{"id":"R8-T5","title":"同步主台账的门禁说明，明确 strict 与 release 的完成口径","priority":5,"prompt":"改动范围：`docs/plans/2026-02-27-ui-cupertino-diff.md`、`PLANS.md`。新增“门禁执行口径”小节：`strict` 代表结构与静态证据可用、`release` 代表 N-VAL-01 可发布收口；并在 `N-VAL-01` 条目中引用 `tool/ui_goal_gate.sh --release` 作为最终判定命令。预期行为：文档状态定义与脚本行为一致，避免出现“文档写 blocked 但脚本显示通过”的解释冲突。验证方式：1) 两份文档均出现 `ui_goal_gate.sh`、`strict`、`release`、`N-VAL-01` 关键说明；2) 关键字检索不再只依赖手工描述。","verify_cmd":"rg -n \"ui_goal_gate\\.sh|strict|release|N-VAL-01\" docs/plans/2026-02-27-ui-cupertino-diff.md PLANS.md","required_paths":["docs/plans/2026-02-27-ui-cupertino-diff.md","PLANS.md","tool/ui_goal_gate.sh"],"depends_on":["R8-T4"]}],"notes":["本批任务均为可落地执行的代码/脚本/文档结构化改造，避免使用 `flutter analyze`，符合仓库当前约束。","当前未把目标判定为 done：因为 `N-VAL-01` 仍是 blocked，且尚缺“发布级门禁”来给出客观收口结论。"]}