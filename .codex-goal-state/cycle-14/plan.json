{"done":false,"done_reason":"大目标未完成：当前仓库仍存在 D-03（theme_setting 底层主题链路未闭环）、D-04（other 设置缺口键未补齐且依赖 D-03）以及 N-VAL-01（导航专项收口证据未完成）三个未收口项。","goal_summary":"按 AGENTS.md 继续推进 UI 迁移：先完成 D-03，再解锁并完成 D-04，最后完成导航专项收口。","tasks":[{"id":"C14-T01","title":"D-03：补齐主题底层字段（含日夜背景图）到 AppSettings/SettingsService","priority":1,"prompt":"改动范围：仅修改 `lib/core/models/app_settings.dart` 与 `lib/core/services/settings_service.dart`。基于 legado `pref_config_theme.xml` 和 `ThemeConfigFragment.kt`，补齐 theme_setting 侧尚缺字段与读写接口：至少包含 `backgroundImage`、`backgroundImageNight`（可选再包含对应模糊度字段，若实现则需同样串接序列化与保存接口）。预期行为：字段具备默认值、fromJson/toJson 兼容、copyWith 透传，以及 `SettingsService` 对应 `save*` 方法；不改变 `appearanceMode` 的单入口语义。验证方式：1）检索字段在模型定义/fromJson/toJson/copyWith 全部出现；2）检索 `SettingsService` 新增 `saveBackgroundImage*`（及可选 blur）方法；3）对改动文件执行格式检查。","verify_cmd":"rg -n \"backgroundImage|backgroundImageNight|bgImage|bgImageN|saveBackgroundImage|saveBgImage|save.*Blurring\" lib/core/models/app_settings.dart lib/core/services/settings_service.dart && dart format --output=none --set-exit-if-changed lib/core/models/app_settings.dart lib/core/services/settings_service.dart","required_paths":["lib/core/models/app_settings.dart","lib/core/services/settings_service.dart"],"depends_on":[]},{"id":"C14-T02","title":"D-03：主题配置服务补齐“保存当前主题/应用主题”能力","priority":2,"prompt":"改动范围：仅修改 `lib/features/settings/models/theme_config_entry.dart` 与 `lib/features/settings/services/theme_config_service.dart`（必要时可补最小辅助函数，不扩散到无关目录）。对齐 legado `saveDayTheme/saveNightTheme` 与 ThemeList 行为，新增：1）保存当前白天/夜间主题为命名配置；2）将已保存配置应用到现有设置模型（颜色与相关背景字段）；3）保持导入/分享/删除兼容。预期行为：主题配置不再是只读列表，能够真正保存与应用，且 JSON 兼容历史数据。验证方式：1）检索 service 中存在 `saveCurrentTheme*` 与 `applyThemeConfig*`（命名可不同但语义必须明确）；2）`ThemeConfigEntry` 字段与序列化覆盖应用所需数据；3）格式检查通过。","verify_cmd":"rg -n \"save.*Theme|apply.*Theme|current.*Theme|importFromClipboardText|sharePayloadAt|deleteAt\" lib/features/settings/services/theme_config_service.dart lib/features/settings/models/theme_config_entry.dart && dart format --output=none --set-exit-if-changed lib/features/settings/services/theme_config_service.dart lib/features/settings/models/theme_config_entry.dart","required_paths":["lib/features/settings/services/theme_config_service.dart","lib/features/settings/models/theme_config_entry.dart"],"depends_on":["C14-T01"]},{"id":"C14-T03","title":"D-03：主题设置页接线背景图与“保存日/夜主题”入口","priority":3,"prompt":"改动范围：仅修改 `lib/features/settings/views/theme_settings_view.dart`、`lib/features/settings/views/appearance_settings_view.dart`、`lib/features/settings/views/theme_config_list_view.dart`。将 D-03 页面闭环补齐：1）提供白天/夜间背景图编辑入口（Cupertino ActionSheet/对话框语义，同义于 legacy 选择/删除）；2）提供“保存白天主题/保存夜间主题”入口并调用 `ThemeConfigService`；3）主题列表点击改为真正应用配置，不再仅弹“请到主题模式切换”提示。预期行为：用户可在主题设置链路完成保存、应用、回显闭环，同时仍不新增 `themeMode` 并行写入口。验证方式：1）检索旧占位文案“主题应用不再修改主题模式”已移除；2）检索页面调用新增 `ThemeConfigService` 保存/应用方法；3）检索背景图入口与保存方法调用；4）格式检查通过。","verify_cmd":"rg -n \"主题应用不再修改主题模式\" lib/features/settings/views/theme_config_list_view.dart ; test $? -eq 1 && rg -n \"save.*Theme|apply.*Theme|backgroundImage|backgroundImageNight|saveBackgroundImage\" lib/features/settings/views/theme_settings_view.dart lib/features/settings/views/appearance_settings_view.dart lib/features/settings/views/theme_config_list_view.dart && dart format --output=none --set-exit-if-changed lib/features/settings/views/theme_settings_view.dart lib/features/settings/views/appearance_settings_view.dart lib/features/settings/views/theme_config_list_view.dart","required_paths":["lib/features/settings/views/theme_settings_view.dart","lib/features/settings/views/appearance_settings_view.dart","lib/features/settings/views/theme_config_list_view.dart"],"depends_on":["C14-T02"]},{"id":"C14-T04","title":"D-04：补齐 Other 缺口键的数据模型与保存接口（非 Web 运行态）","priority":4,"prompt":"改动范围：仅修改 `lib/core/models/app_settings.dart` 与 `lib/core/services/settings_service.dart`。补齐 D-04 缺口键：`cronet`、`antiAlias`、`mediaButtonOnExit`、`readAloudByMediaButton`、`ignoreAudioFocus`、`autoClearExpired`、`showAddToShelfAlert`、`updateToVariant`、`showMangaUi`，并完成字段定义、默认值、序列化、copyWith 与 `save*` 接口。预期行为：上述键可持久化与回显；严格保持 `EX-01` 边界，不实现 WebService 启停/地址/端口重启逻辑。验证方式：1）检索新增键在模型与服务层均存在；2）确认未新增 `WebService.start/stop` 调用；3）格式检查通过。","verify_cmd":"rg -n \"cronet|antiAlias|mediaButtonOnExit|readAloudByMediaButton|ignoreAudioFocus|autoClearExpired|showAddToShelfAlert|updateToVariant|showMangaUi\" lib/core/models/app_settings.dart lib/core/services/settings_service.dart && rg -n \"WebService\\.start|WebService\\.stop\" lib/core/services/settings_service.dart lib/features/settings/views/other_settings_view.dart ; test $? -eq 1 && dart format --output=none --set-exit-if-changed lib/core/models/app_settings.dart lib/core/services/settings_service.dart","required_paths":["lib/core/models/app_settings.dart","lib/core/services/settings_service.dart"],"depends_on":["C14-T03"]},{"id":"C14-T05","title":"D-04：OtherSettingsView 增加缺口键的 Cupertino 交互入口","priority":5,"prompt":"改动范围：仅修改 `lib/features/settings/views/other_settings_view.dart`。在“其它设置”中新增 D-04 缺口键 UI（CupertinoSwitch/选择器），并与 `SettingsService` 新增保存接口接线；`updateToVariant` 使用枚举或固定选项，文案与 legacy 语义保持同义。预期行为：非 Web 缺口键可配置、可即时回显；“Web 服务（未启用）”区块继续保留只读占位，不新增运行态行为。验证方式：1）检索页面调用新增 `save*` 方法；2）检索“Web 服务（未启用）”文案仍在；3）检索未出现 `WebService.start/stop`；4）格式检查通过。","verify_cmd":"rg -n \"save.*Cronet|save.*AntiAlias|save.*MediaButtonOnExit|save.*ReadAloudByMediaButton|save.*IgnoreAudioFocus|save.*AutoClearExpired|save.*ShowAddToShelfAlert|save.*UpdateToVariant|save.*ShowMangaUi|Web 服务（未启用）\" lib/features/settings/views/other_settings_view.dart && rg -n \"WebService\\.start|WebService\\.stop\" lib/features/settings/views/other_settings_view.dart ; test $? -eq 1 && dart format --output=none --set-exit-if-changed lib/features/settings/views/other_settings_view.dart","required_paths":["lib/features/settings/views/other_settings_view.dart"],"depends_on":["C14-T04"]},{"id":"C14-T06","title":"收口台账：同步 D-03/D-04 与 N-VAL-01 状态","priority":6,"prompt":"改动范围：仅修改 `docs/plans/2026-02-26-my-menu-id-diff.md`、`docs/plans/2026-02-26-my-menu-parity-checklist.md`、`docs/plans/2026-02-27-ui-cupertino-diff.md` 与四份导航证据 `docs/plans/evidence/2026-02-27-ui-nav-final-regression/R-N01-bookshelf.md`、`R-N02-discovery.md`、`R-N03-rss.md`、`R-N04-settings.md`。在前述代码闭环后回填状态：D-03 置为 done、D-04 置为 done（若本轮完成）或 in_progress（若未全完），并完成 N-VAL-01 证据收口。预期行为：文档状态与代码一致、依赖链仍显式保留、`EX-01 blocked` 不被改动。验证方式：1）检索文档不再含 D-03 in_progress 与 N-VAL-01 pending；2）检索仍保留 EX-01 blocked；3）检索四个核心页 `useSliverNavigationBar: true` 仍存在。","verify_cmd":"rg -n \"D-03=.*done|D-04=.*(done|in_progress)|N-VAL-01=.*done|EX-01=blocked\" docs/plans/2026-02-26-my-menu-id-diff.md docs/plans/2026-02-26-my-menu-parity-checklist.md docs/plans/2026-02-27-ui-cupertino-diff.md && rg -n \"待验证|待回填\" docs/plans/evidence/2026-02-27-ui-nav-final-regression/R-N01-bookshelf.md docs/plans/evidence/2026-02-27-ui-nav-final-regression/R-N02-discovery.md docs/plans/evidence/2026-02-27-ui-nav-final-regression/R-N03-rss.md docs/plans/evidence/2026-02-27-ui-nav-final-regression/R-N04-settings.md ; test $? -eq 1 && rg -n \"useSliverNavigationBar:\\s*true\" lib/features/bookshelf/views/bookshelf_view.dart lib/features/discovery/views/discovery_view.dart lib/features/rss/views/rss_subscription_view.dart lib/features/settings/views/settings_view.dart","required_paths":["docs/plans/2026-02-26-my-menu-id-diff.md","docs/plans/2026-02-26-my-menu-parity-checklist.md","docs/plans/2026-02-27-ui-cupertino-diff.md","docs/plans/evidence/2026-02-27-ui-nav-final-regression/R-N01-bookshelf.md","docs/plans/evidence/2026-02-27-ui-nav-final-regression/R-N02-discovery.md","docs/plans/evidence/2026-02-27-ui-nav-final-regression/R-N03-rss.md","docs/plans/evidence/2026-02-27-ui-nav-final-regression/R-N04-settings.md"],"depends_on":["C14-T05"]}],"notes":["上一轮 failed 为空完成项且重复失败 C13-T01（125/126）；本轮任务沿用串行链路但把 D-03 拆得更细，降低单任务失败面。","严格遵守 AGENTS 约束：`D-03 -> D-04` 串行推进，`EX-01` 持续 blocked，不进入 WebService 运行态实现。"]}