{"done":false,"done_reason":"核心页大标题迁移未完成：四个主 Tab 页面尚未接入大标题模式（`CupertinoSliverNavigationBar` 仍未在业务页使用）。","goal_summary":"围绕 AGENTS 的 UI 迁移约束，下一批应先补齐壳层滚动控制能力，再并行改造书架/发现/订阅/我的四个核心页接入大标题导航，最后回填台账与回归证据。","tasks":[{"id":"R5-T01","title":"补齐壳层大标题滚动控制能力（N-PRE-01 收口）","priority":1,"prompt":"改动范围：`lib/app/widgets/app_cupertino_page_scaffold.dart`。在现有 `useSliverNavigationBar` 分支上新增可选滚动控制参数（如 `sliverScrollController`、`sliverScrollPhysics`，命名可同义），并透传给内部 `CustomScrollView`；保持默认参数下旧页面行为不变。预期行为：不传新参数时与当前完全一致；传入滚动控制参数后，业务页可通过外部 `ScrollController` 驱动大标题展开/折叠回顶。验证方式：1) `dart format lib/app/widgets/app_cupertino_page_scaffold.dart`；2) `rg -n \"useSliverNavigationBar|CupertinoSliverNavigationBar|CustomScrollView|sliverScroll\" lib/app/widgets/app_cupertino_page_scaffold.dart`；3) 手工在任一接入页执行一次回顶操作确认标题状态可恢复为 large title。","verify_cmd":"dart format lib/app/widgets/app_cupertino_page_scaffold.dart && rg -n \"useSliverNavigationBar|CupertinoSliverNavigationBar|CustomScrollView|sliverScroll\" lib/app/widgets/app_cupertino_page_scaffold.dart","required_paths":["lib/app/widgets/app_cupertino_page_scaffold.dart"],"depends_on":[]},{"id":"R5-T02","title":"书架页接入大标题导航（N-01）","priority":2,"prompt":"改动范围：`lib/features/bookshelf/views/bookshelf_view.dart`。将页面根容器切换为 `AppCupertinoPageScaffold` 大标题模式（`useSliverNavigationBar: true`），并把现有列表/空态/错误态改为 sliver 结构（`sliverBodyBuilder`）；复用现有 `_scrollController` 与 `reselectSignal` 回顶逻辑，保证顶部重点按后回顶且大标题恢复展开。预期行为：书架首帧显示 large title，上滑折叠为 inline title；现有 trailing 菜单与搜索入口行为不变。验证方式：1) `dart format lib/features/bookshelf/views/bookshelf_view.dart`；2) `rg -n \"useSliverNavigationBar:\\s*true|sliverBodyBuilder|reselectSignal|_scrollController\" lib/features/bookshelf/views/bookshelf_view.dart`；3) 手工路径：进入书架->下滑/上滑验证折叠->重复点击书架 Tab 验证回顶与标题展开。","verify_cmd":"dart format lib/features/bookshelf/views/bookshelf_view.dart && rg -n \"useSliverNavigationBar:\\s*true|sliverBodyBuilder|reselectSignal|_scrollController\" lib/features/bookshelf/views/bookshelf_view.dart","required_paths":["lib/features/bookshelf/views/bookshelf_view.dart"],"depends_on":["R5-T01"]},{"id":"R5-T03","title":"发现页接入大标题导航（N-02）","priority":3,"prompt":"改动范围：`lib/features/discovery/views/discovery_view.dart`。将页面改为大标题模式，并把“搜索区 + 列表/空态”改造成单一 sliver 滚动体系，避免 Column+ListView 嵌套滚动；保持 `compressSignal` 触发回顶/收起时与大标题状态同步。预期行为：首屏 large title，滚动折叠稳定无抖动；分组筛选、展开书源、进入二级页面行为不变。验证方式：1) `dart format lib/features/discovery/views/discovery_view.dart`；2) `rg -n \"useSliverNavigationBar:\\s*true|sliverBodyBuilder|compressSignal|_scrollController\" lib/features/discovery/views/discovery_view.dart`；3) 手工路径：发现页滚动折叠、再次点击 Tab 回顶、检查 large title 恢复。","verify_cmd":"dart format lib/features/discovery/views/discovery_view.dart && rg -n \"useSliverNavigationBar:\\s*true|sliverBodyBuilder|compressSignal|_scrollController\" lib/features/discovery/views/discovery_view.dart","required_paths":["lib/features/discovery/views/discovery_view.dart"],"depends_on":["R5-T01"]},{"id":"R5-T04","title":"订阅页接入大标题导航（N-03）","priority":4,"prompt":"改动范围：`lib/features/rss/views/rss_subscription_view.dart`。切换为大标题模式，并将顶部搜索区、规则订阅入口、订阅源列表整合为 sliver 流；保持现有三枚右上角操作按钮与长按动作菜单语义不变。预期行为：首屏 large title、滚动折叠正常；筛选统计与列表点击行为保持一致。验证方式：1) `dart format lib/features/rss/views/rss_subscription_view.dart`；2) `rg -n \"useSliverNavigationBar:\\s*true|sliverBodyBuilder|CupertinoSearchTextField|_buildList\" lib/features/rss/views/rss_subscription_view.dart`；3) 手工路径：订阅页滚动折叠、筛选输入、打开任一源详情并返回。","verify_cmd":"dart format lib/features/rss/views/rss_subscription_view.dart && rg -n \"useSliverNavigationBar:\\s*true|sliverBodyBuilder|CupertinoSearchTextField|_buildList\" lib/features/rss/views/rss_subscription_view.dart","required_paths":["lib/features/rss/views/rss_subscription_view.dart"],"depends_on":["R5-T01"]},{"id":"R5-T05","title":"我的页接入大标题导航（N-04）","priority":5,"prompt":"改动范围：`lib/features/settings/views/settings_view.dart`。切换为大标题模式，保持“帮助按钮、分组列表、各入口跳转、退出行为”等现有交互不变；将主体列表改为 sliver 兼容结构，确保 iOS 根页不被侧滑返回误触。预期行为：我的页首屏 large title，上滑折叠后保持菜单可用；进入二级页后仍支持侧滑返回。验证方式：1) `dart format lib/features/settings/views/settings_view.dart`；2) `rg -n \"useSliverNavigationBar:\\s*true|sliverBodyBuilder|my_menu_|SystemNavigator.pop\" lib/features/settings/views/settings_view.dart`；3) 手工路径：我的页滚动折叠->进入“主题设置/其它设置”->侧滑返回。","verify_cmd":"dart format lib/features/settings/views/settings_view.dart && rg -n \"useSliverNavigationBar:\\s*true|sliverBodyBuilder|my_menu_|SystemNavigator.pop\" lib/features/settings/views/settings_view.dart","required_paths":["lib/features/settings/views/settings_view.dart"],"depends_on":["R5-T01"]},{"id":"R5-T06","title":"回填 UI 台账与导航专项回归证据（N-VAL-01）","priority":6,"prompt":"改动范围：`docs/plans/2026-02-27-ui-cupertino-diff.md`、`PLANS.md` 及必要的回归证据文档（放在 `docs/plans/evidence/` 对应目录）。回填 `N-PRE-01`、`N-01~N-04` 的完成状态与手工验证结论，明确记录 `N-AC-01~03`（标题折叠、滚动稳定、返回手势）逐项结果；若有未达项，按 AGENTS 1.1.2 标记 `blocked` 并写清原因/影响/替代/回补计划。预期行为：台账状态与代码一致，可直接作为下一轮基线。验证方式：1) `rg -n \"N-PRE-01|N-01|N-02|N-03|N-04|N-VAL-01|N-AC-01|N-AC-02|N-AC-03|blocked\" docs/plans/2026-02-27-ui-cupertino-diff.md PLANS.md`；2) `rg -n \"CupertinoSliverNavigationBar|useSliverNavigationBar\" lib/features/bookshelf/views/bookshelf_view.dart lib/features/discovery/views/discovery_view.dart lib/features/rss/views/rss_subscription_view.dart lib/features/settings/views/settings_view.dart`。","verify_cmd":"rg -n \"N-PRE-01|N-01|N-02|N-03|N-04|N-VAL-01|N-AC-01|N-AC-02|N-AC-03|blocked\" docs/plans/2026-02-27-ui-cupertino-diff.md PLANS.md && rg -n \"CupertinoSliverNavigationBar|useSliverNavigationBar\" lib/features/bookshelf/views/bookshelf_view.dart lib/features/discovery/views/discovery_view.dart lib/features/rss/views/rss_subscription_view.dart lib/features/settings/views/settings_view.dart","required_paths":["docs/plans/2026-02-27-ui-cupertino-diff.md","PLANS.md","docs/plans/evidence"],"depends_on":["R5-T02","R5-T03","R5-T04","R5-T05"]}],"notes":["上一轮失败记录显示队列执行重试耗尽（rc=125），本轮任务已拆成更细粒度、可单独验证的 6 项，降低单任务复杂度与重试成本。","当前代码已出现 `AppCupertinoPageScaffold` 大标题分支，但四个核心页面尚未实际接入；因此目标未完成。"]}